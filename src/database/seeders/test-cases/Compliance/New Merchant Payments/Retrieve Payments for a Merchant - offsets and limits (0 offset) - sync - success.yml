name: Retrieve Payments for a Merchant - offsets and limits (0 offset) - sync - success
slug: retrieve-payments-merchant-offsets-and-limits-zero-offset-sync-success
use_case: Merchant Payments (New)s (New)
behavior: positive
description: |
  Service Provider requests their own account transaction history specifying an offset and limit through the Mobile Money API and the Mobile Money Provider handles the request and successfully responds synchronously with an account transaction list which starts at the offset and contains the number of records specified by the limit.
precondition: |
  - Mobile Money API Provider has GSMA Mobile Money API Implemented.
  - Define the envrionment variables to customise this test case:
    - X_CLIENT_ID, default value is `MERCHANT67890`
  - Required Parameters for Execution:
    - IDENTIFIER_TYPE, default value is `msisdn`
    - IDENTIFIER, default value is `+33555000200`
components:
  -
    name: 'Service Provider'
    slug: sp
  -
    name: 'Mobile Money API Provider'
    slug: mmap
test_steps:
  -
    path: '/accounts/{identifierType}/{identifier}/transactions'
    pattern: '^accounts/msisdn/[+]?[0-9]{6,15}/transactions$'
    method: GET
    source: sp
    target: mmap
    api_spec: 'MM v1.2.0'
    test_request_scripts:
      -
        name: 'Header has the X-Client-Id'
        rules:
          headers.x-client-id: required
    test_response_scripts:
      -
        name: 'Response request was successfully received'
        rules:
          status: 'required|in:200'
      -
        name: 'Response array is specified correctly with a maximun of 20 transactions'
        rules:
          'body.*':
            - required
            - array
            - 'max:20'
    request:
      method: GET
      uri: '/accounts/{{ env.IDENTIFIER_TYPE|default("msisdn") }}/{{ env.IDENTIFIER|default("+33555000200") }}/transactions?offset=0&limit=20'
      headers:
        x-date: '{{ new_date_iso8601() }}'
        x-client-id: '{{ env.X_CLIENT_ID|default("MERCHANT67890")}}'
        content-type: application/json
      body:
        requestDate: '{{ new_date_iso8601() }}'
    response:
      status: 200
      headers:
        x-date: '{{ new_date_iso8601() }}'
        content-type: application/json
      body:
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
        -
          type: disbursement
          amount: '20.01'
          currency: USD
          debitParty:
            -
              key: msisdn
              value: '+33555000201'
          creditParty:
            -
              key: msisdn
              value: '+33555000200'
          transactionStatus: completed
          transactionReference: '{{ uuidv4() }}'
